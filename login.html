<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sign In / Sign Up - AI Travel Planner</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=San+Francisco+Display:wght@400;600&display=swap');
    *{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:'San Francisco Display',sans-serif;height:100vh;display:flex;align-items:center;justify-content:center;background:#000;color:#fff;}
    .auth-container{background:#111;padding:2rem;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.5);width:90%;max-width:360px;}
    h2{text-align:center;margin-bottom:1.5rem;color:#f33;font-weight:600;}
    .input-group{position:relative;margin-bottom:1rem;}
    .input-group label{display:block;margin-bottom:0.5rem;font-size:0.9rem;color:#ddd;}
    .input-group input{width:100%;padding:0.75rem;border:1px solid #333;border-radius:8px;background:#222;color:#fff;}
    .show-pw{position:absolute;right:1rem;top:2.6rem;cursor:pointer;font-size:0.85rem;color:#f33;}
    .error-msg{display:block;min-height:1em;margin-top:0.25rem;font-size:0.8rem;color:#f33;}
    .btn{width:100%;padding:0.75rem;background:#f33;border:none;border-radius:8px;font-size:1rem;cursor:pointer;transition:background 0.3s;color:#fff;font-weight:600;}
    .btn:hover{background:#d22;}
    .toggle-msg{text-align:center;margin-top:1rem;font-size:0.9rem;color:#bbb;}
    .toggle-msg a{color:#f33;text-decoration:none;font-weight:600;cursor:pointer;}
  </style>
</head>
<body>
  <!-- Sign In Page -->
  <div class="auth-container" id="signin-container">
    <h2>Sign In</h2>
    <form id="signin-form" action="/login" method="POST" novalidate>
      <div class="input-group">
        <label for="user">Username or Email</label>
        <input type="text" id="user" name="user" required />
        <span class="error-msg" id="user-error"></span>
      </div>
      <div class="input-group password-group">
        <label for="password">Password</label>
        <input type="password" id="password" name="password" required />
        <span class="show-pw" onclick="togglePassword('password')">Show</span>
        <span class="error-msg" id="password-error"></span>
      </div>
      <button type="submit" class="btn">Sign In</button>
    </form>
    <p class="toggle-msg">Don't have an account? <a href="javascript:void(0)" onclick="showSignup(event)">Sign up</a>.</p>
  </div>

  <!-- Sign Up Page -->
  <div class="auth-container" id="signup-container" style="display: none;">
    <h2>Sign Up</h2>
    <form id="signup-form" novalidate>
      <div class="input-group">
        <label for="firstname">First Name</label>
        <input type="text" id="firstname" name="firstname" required />
        <span class="error-msg" id="firstname-error"></span>
      </div>
      <div class="input-group">
        <label for="lastname">Last Name</label>
        <input type="text" id="lastname" name="lastname" required />
        <span class="error-msg" id="lastname-error"></span>
      </div>
      <div class="input-group">
        <label for="email">Email</label>
        <input type="email" id="email" name="email" required />
        <span class="error-msg" id="email-error"></span>
      </div>
      <div class="input-group">
        <label for="phone">Phone Number</label>
        <input type="tel" id="phone" name="phone" placeholder="xxxxxx or +91xxxxxx" required />
        <span class="error-msg" id="phone-error"></span>
      </div>
      <button type="button" class="btn" onclick="sendOTP()">Send OTP</button>
    </form>
    <p class="toggle-msg">Already have an account? <a href="javascript:void(0)" onclick="showSignin(event)">Sign in</a>.</p>
  </div>

  <script>
    const validators = {
      firstname: { pattern: /^[A-Za-z]{1,20}$/, message: 'First name: only letters, max 20 chars.' },
      lastname:  { pattern: /^[A-Za-z]{1,20}$/, message: 'Last name: only letters, max 20 chars.' },
      email:     { pattern: /^[^\s@]+@[^\s@]+\.[^\s@]+$/, message: 'Please enter a valid email address.' },
      phone:     { pattern: /^\+?\d{10,15}$/, message: 'Please enter a valid phone number (10â€“15 digits, optional +).' }
    };

    function togglePassword(id) {
      const el = document.getElementById(id);
      el.type = el.type === 'password' ? 'text' : 'password';
    }

    function showSignup(e) {
      e.preventDefault();
      resetForm('signin-form');
      document.getElementById('signin-container').style.display = 'none';
      document.getElementById('signup-container').style.display = 'block';
    }
    function showSignin(e) {
      e.preventDefault();
      resetForm('signup-form');
      document.getElementById('signup-container').style.display = 'none';
      document.getElementById('signin-container').style.display = 'block';
    }

    function resetForm(formId) {
      const form = document.getElementById(formId);
      if (form) form.reset();
      document.querySelectorAll('.error-msg').forEach(e => e.textContent = '');
    }

    Object.entries(validators).forEach(([field, {pattern, message}]) => {
      const input = document.getElementById(field);
      const errorEl = document.getElementById(field + '-error');
      if (!input) return;
      const fn = () => {
        if (!pattern.test(input.value)) errorEl.textContent = message;
        else errorEl.textContent = '';
      };
      input.addEventListener('input', fn);
      input.addEventListener('blur', fn);
    });

    function sendOTP() {
      let valid = true;
      Object.entries({firstname: 'first name', lastname: 'last name', email: 'email address', phone: 'phone number'}).forEach(([field, label]) => {
        const input = document.getElementById(field);
        const errorEl = document.getElementById(field + '-error');
        if (!input.value.trim()) {
          errorEl.textContent = `Please enter your ${label}.`;
          valid = false;
        } else if (!validators[field].pattern.test(input.value)) {
          errorEl.textContent = validators[field].message;
          valid = false;
        } else {
          errorEl.textContent = '';
        }
      });
      if (!valid) return;
      const phone = document.getElementById('phone').value;
      alert(`OTP sent to ${phone}!`);
      window.location.href = `/verify-otp?phone=${encodeURIComponent(phone)}`;
    }

    document.getElementById('signin-form').addEventListener('submit', e => {
      const user = document.getElementById('user');
      const pass = document.getElementById('password');
      let ok = true;
      if (!user.value.trim()) { document.getElementById('user-error').textContent = 'Required.'; ok = false; }
      if (!pass.value)     { document.getElementById('password-error').textContent = 'Required.'; ok = false; }
      if (!ok) e.preventDefault();
    });
  </script>
</body>
</html>
